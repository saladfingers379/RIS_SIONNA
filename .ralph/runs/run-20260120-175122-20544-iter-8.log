OpenAI Codex v0.87.0 (research preview)
--------
workdir: /home/josh/Documents/Github/RIS_SIONNA
model: gpt-5.2-codex
provider: openai
approval: never
sandbox: danger-full-access
reasoning effort: none
reasoning summaries: auto
session id: 019bdcbd-ec20-77a0-8fe9-f12322126705
--------
user
# Build

You are an autonomous coding agent. Your task is to complete the work for exactly one story and record the outcome.

## Paths
- PRD: /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks/prd-ris-lab.json
- AGENTS (optional): /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md
- Progress Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md
- Guardrails: /home/josh/Documents/Github/RIS_SIONNA/.ralph/guardrails.md
- Guardrails Reference: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph/references/GUARDRAILS.md
- Context Reference: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph/references/CONTEXT_ENGINEERING.md
- Errors Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/errors.log
- Activity Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/activity.log
- Activity Logger: /home/josh/Documents/Github/RIS_SIONNA/ralph log
- No-commit: false
- Repo Root: /home/josh/Documents/Github/RIS_SIONNA
- Run ID: 20260120-175122-20544
- Iteration: 8
- Run Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.log
- Run Summary: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.md

## Global Quality Gates (apply to every story)
- python -m pytest

## Selected Story (Do not change scope)
ID: US-007
Title: Add MAT reference import (stretch)

Story details:
### US-007: Add MAT reference import (stretch)
Status: in_progress
Depends on: US-005

Description:
As a user, I want optional MAT import support when easy to enable.

Acceptance Criteria:
- [ ] If MAT import is enabled, document and add scipy as an optional dependency (extras)
- [ ] Example: MAT file containing theta_deg + pattern_db validates and generates overlay plots
- [ ] Negative case: when scipy is missing, CLI returns an actionable install message


If the story details are empty or missing, STOP and report that the PRD story format could not be parsed.

## Rules (Non-Negotiable)
- Implement **only** the work required to complete the selected story.
- Complete all tasks associated with this story (and only this story).
- Do NOT ask the user questions.
- Do NOT change unrelated code.
- Do NOT assume something is unimplemented — confirm by reading code.
- Implement completely; no placeholders or stubs.
- If No-commit is true, do NOT commit or push changes.
- Do NOT edit the PRD JSON (status is handled by the loop).
- All changes made during the run must be committed (including updates to progress/logs).
 - Before committing, perform a final **security**, **performance**, and **regression** review of your changes.

## Your Task (Do this in order)
1. Read /home/josh/Documents/Github/RIS_SIONNA/.ralph/guardrails.md before any code changes.
2. Read /home/josh/Documents/Github/RIS_SIONNA/.ralph/errors.log for repeated failures to avoid.
3. Read /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks/prd-ris-lab.json for global context (do not edit).
4. Fully audit and read all necessary files to understand the task end-to-end before implementing. Do not assume missing functionality.
5. If /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md exists, follow its build/test instructions.
6. Implement only the tasks that belong to US-007.
7. Run verification commands listed in the story, the global quality gates, and in /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md (if required).
8. If the project has a build or dev workflow, run what applies:
   - Build step (e.g., `npm run build`) if defined.
   - Dev server (e.g., `npm run dev`, `wrangler dev`) if it is the normal validation path.
   - Confirm no runtime/build errors in the console.
9. Perform a brief audit before committing:
   - **Security:** check for obvious vulnerabilities or unsafe handling introduced by your changes.
   - **Performance:** check for avoidable regressions (extra queries, heavy loops, unnecessary re-renders).
   - **Regression:** verify existing behavior that could be impacted still works.
10. If No-commit is false, commit changes using the `$commit` skill.
    - Stage everything: `git add -A`
    - Confirm a clean working tree after commit: `git status --porcelain` should be empty.
    - After committing, capture the commit hash and subject using:
      `git show -s --format="%h %s" HEAD`.
11. Append a progress entry to /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md with run/commit/test details (format below).
    If No-commit is true, skip committing and note it in the progress entry.

## Progress Entry Format (Append Only)
```
## [Date/Time] - US-007: Add MAT reference import (stretch)
Thread: [codex exec session id if available, otherwise leave blank]
Run: 20260120-175122-20544 (iteration 8)
Run log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.log
Run summary: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.md
- Guardrails reviewed: yes
- No-commit run: false
- Commit: <hash> <subject> (or `none` + reason)
- Post-commit status: `clean` or list remaining files
- Verification:
  - Command: <exact command> -> PASS/FAIL
  - Command: <exact command> -> PASS/FAIL
- Files changed:
  - <file path>
  - <file path>
- What was implemented
- **Learnings for future iterations:**
  - Patterns discovered
  - Gotchas encountered
  - Useful context
---
```

## Completion Signal
Only output the completion signal when the **selected story** is fully complete and verified.
When the selected story is complete, output:
<promise>COMPLETE</promise>

Otherwise, end normally without the signal.

## Additional Guardrails
- When authoring documentation, capture the why (tests + implementation intent).
- If you learn how to run/build/test the project, update /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md briefly (operational only).
- Keep AGENTS operational only; progress notes belong in /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md.
- If you hit repeated errors, log them in /home/josh/Documents/Github/RIS_SIONNA/.ralph/errors.log and add a Sign to /home/josh/Documents/Github/RIS_SIONNA/.ralph/guardrails.md using /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph/references/GUARDRAILS.md as the template.

## Activity Logging (Required)
Log major actions to /home/josh/Documents/Github/RIS_SIONNA/.ralph/activity.log using the helper:
```
/home/josh/Documents/Github/RIS_SIONNA/ralph log "message"
```
Log at least:
- Start of work on the story
- After major code changes
- After tests/verification
- After updating progress log

## Browser Testing (Required for Frontend Stories)
If the selected story changes UI, you MUST verify it in the browser:
1. Load the `dev-browser` skill.
2. Navigate to the relevant page.
3. Verify the UI changes work as expected.
4. Take a screenshot if helpful for the progress log.

A frontend story is NOT complete until browser verification passes.

mcp: filesystem starting
mcp: memory starting
mcp: context7 starting
mcp: context7 ready
mcp: memory ready
mcp: filesystem ready
mcp startup: ready: context7, memory, filesystem

thinking
**Starting with guardrails and PRD**
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.ralph/guardrails.md' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 2ms:
# Guardrails (Signs)

> Lessons learned from failures. Read before acting.

## Core Signs

### Sign: Read Before Writing
- **Trigger**: Before modifying any file
- **Instruction**: Read the file first
- **Added after**: Core principle

### Sign: Test Before Commit
- **Trigger**: Before committing changes
- **Instruction**: Run required tests and verify outputs
- **Added after**: Core principle

---

## Learned Signs


thinking
**Reading errors**
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.ralph/errors.log' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
# Error Log

> Failures and repeated issues. Use this to add guardrails.

[2026-01-20 17:57:10] ITERATION 1 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-1.md
[2026-01-20 18:09:25] ITERATION 2 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-2.md
[2026-01-20 18:22:02] ITERATION 3 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-3.md
[2026-01-20 18:31:34] ITERATION 4 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-4.md
[2026-01-20 18:38:12] ITERATION 5 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-5.md
[2026-01-20 18:44:26] ITERATION 6 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-6.md
[2026-01-20 18:49:50] ITERATION 7 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-7.md

thinking
**Preparing to read PRD JSON**
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks/prd-ris-lab.json' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
{
  "version": 1,
  "project": "RIS Lab (Validation First)",
  "overview": "Add a RIS Lab module to design and validate RIS behaviors against MATLAB and paper-style references with reproducible CLI and Simulator-UI runs, saving full artifacts for regression testing.",
  "goals": [
    "Provide deterministic RIS math, control synthesis, and pattern/link validation via CLI and Simulator UI",
    "Reproduce MATLAB reference patterns within configurable RMSE + peak-angle thresholds",
    "Persist all run artifacts under outputs/<run_id>/ for regression tracking"
  ],
  "nonGoals": [
    "Ray tracing or Sionna RT RIS integration (no ray-traced RIS scattering)",
    "RIS optimization, auto-tuning, or search algorithms",
    "GIS or map ingestion"
  ],
  "successMetrics": [
    "A validation run matches MATLAB pattern within RMSE threshold and peak-angle error threshold",
    "A run produces all required artifacts under outputs/<run_id>/"
  ],
  "openQuestions": [],
  "defaults": {
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
# AGENTS.md — RIS_SIONNA
**Native Ubuntu 24.04 · GPU-first (CUDA/OptiX) · Sionna RT baseline @ 28 GHz · RIS Lab (validation-first)**

---

## 0. HARD CONTEXT RESET (NON-NEGOTIABLE)

- Primary target: **native Ubuntu 24.04**
- GPU RT target: **CUDA + OptiX (real runtime)**
- WSL may exist as a *CPU-only dev shell*, but **GPU OptiX on WSL is unsupported/unstable** for this repo.
- Any GPU RT failure on native Ubuntu is treated as **misconfiguration**, not “platform limitation”.

This repo must never silently “looks fine” while running CPU/LLVM when a GPU is available.
If we fall back, we must say so loudly and explain why.

---

## 1. SYSTEM ENVIRONMENT (AUTHORITATIVE)

**Baseline assumptions for “GPU-first” work:**

thinking
**Implementing activity start logging**

I'm adding logging of activity start events using the Ralph log system for story US-007.
exec
/usr/bin/zsh -lc '/home/josh/Documents/Github/RIS_SIONNA/ralph log "Start US-007 MAT import support"' in /home/josh/Documents/Github/RIS_SIONNA exited 127 in 2ms:
zsh:1: no such file or directory: /home/josh/Documents/Github/RIS_SIONNA/ralph

thinking
**Checking for missing command script**

I'm listing scripts and commands in the repo to verify if a needed command or script is missing.
exec
/usr/bin/zsh -lc 'ls -la /home/josh/Documents/Github/RIS_SIONNA' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
total 108
drwxrwxr-x 16 josh josh  4096 Jan 20 18:01 .
drwxrwxr-x  3 josh josh  4096 Jan 19 17:55 ..
drwxrwxr-x  4 josh josh  4096 Jan 20 17:19 .agents
-rw-rw-r--  1 josh josh  7343 Jan 20 17:42 AGENTS.md
drwxrwxr-x  6 josh josh  4096 Jan 19 20:19 app
drwxrwxr-x  4 josh josh  4096 Jan 19 23:11 build
drwxrwxr-x  3 josh josh  4096 Jan 20 16:20 .codex
drwxrwxr-x  2 josh josh  4096 Jan 19 23:02 configs
drwxrwxr-x  2 josh josh  4096 Jan 19 20:03 docs
drwxrwxr-x  8 josh josh  4096 Jan 20 18:49 .git
-rw-rw-r--  1 josh josh    45 Jan 19 17:55 .gitignore
-rw-rw-r--  1 josh josh   228 Jan 19 17:55 Makefile
drwxrwxr-x  7 josh josh  4096 Jan 20 16:23 outputs
-rw-rw-r--  1 josh josh  4736 Jan 19 23:04 PROJECT_CONTEXT.md
-rw-rw-r--  1 josh josh   749 Jan 19 17:55 pyproject.toml
drwxrwxr-x  3 josh josh  4096 Jan 20 18:01 .pytest_cache
drwxrwxr-x  4 josh josh  4096 Jan 20 18:20 .ralph
-rw-rw-r--  1 josh josh 11803 Jan 20 17:37 README.md
-rw-rw-r--  1 josh josh   649 Jan 19 23:04 REPO_STATUS.md

thinking
**Searching for Ralph script**

I'm checking if the 'ralph' script is in the repo root or the .agents directory, using search tools to locate any files named or containing "ralph".
exec
/usr/bin/zsh -lc "rg --files -g 'ralph' /home/josh/Documents/Github/RIS_SIONNA" in /home/josh/Documents/Github/RIS_SIONNA exited 1 in 6ms:


thinking
**Checking for command in PATH**
exec
/usr/bin/zsh -lc 'which ralph' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 2ms:
/home/josh/.npm-global/bin/ralph

thinking
**Starting CLI logging command**
exec
/usr/bin/zsh -lc 'ralph log "Start US-007 MAT import support"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 87ms:
Using local templates: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph

thinking
**Inspecting current validation loader**
exec
/usr/bin/zsh -lc 'rg -n "validate|reference|npz|csv|ris" app/ris' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 6ms:
app/ris/__init__.py:3:from .ris_config import (  # noqa: F401
app/ris/__init__.py:5:    compute_ris_lab_config_hash,
app/ris/__init__.py:6:    load_ris_lab_config,
app/ris/__init__.py:7:    resolve_and_snapshot_ris_lab_config,
app/ris/__init__.py:8:    resolve_ris_lab_config,
app/ris/__init__.py:9:    snapshot_ris_lab_config,
app/ris/__init__.py:11:from .ris_core import (  # noqa: F401
app/ris/ris_lab.py:5:import csv
app/ris/ris_lab.py:17:from app.ris.ris_config import resolve_and_snapshot_ris_lab_config
app/ris/ris_lab.py:18:from app.ris.ris_core import (
app/ris/ris_lab.py:138:    _validate_theta_pattern_lengths(theta_deg, pattern_db, "pattern_db")
app/ris/ris_lab.py:163:def _load_reference_csv(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
app/ris/ris_lab.py:165:        reader = csv.DictReader(handle)
app/ris/ris_lab.py:194:def _load_reference_npz(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
app/ris/ris_lab.py:216:def _validate_theta_pattern_lengths(
app/ris/ris_lab.py:229:    _validate_theta_pattern_lengths(theta_deg, pattern_db, "pattern_db")
app/ris/ris_lab.py:274:def run_ris_lab(config_path: str, mode: str) -> Path:
app/ris/ris_lab.py:275:    config, output_dir, summary = resolve_and_snapshot_ris_lab_config(config_path)
app/ris/ris_lab.py:328:            _validate_theta_pattern_lengths(theta_deg, linear_norm, "pattern_linear")
app/ris/ris_lab.py:329:            _validate_theta_pattern_lengths(theta_deg, pattern_db, "pattern_db")

thinking
**Opening core script file**
exec
/usr/bin/zsh -lc "sed -n '1,240p' /home/josh/Documents/Github/RIS_SIONNA/app/ris/ris_lab.py" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
"""RIS Lab runners for pattern and validation modes."""

from __future__ import annotations

import csv
import logging
import time
from pathlib import Path
from typing import Any, Dict, Tuple

import matplotlib
matplotlib.use("Agg")
import matplotlib.pyplot as plt
import numpy as np

from app.io import save_json
from app.ris.ris_config import resolve_and_snapshot_ris_lab_config
from app.ris.ris_core import (
    compute_element_centers,
    degrees_to_radians,
exec
/usr/bin/zsh -lc "sed -n '240,560p' /home/josh/Documents/Github/RIS_SIONNA/app/ris/ris_lab.py" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
    peak_db = float(pattern_db[peak_idx])
    return {
        "sidelobe_level_db": float(peak_db - sidelobe_peak_db),
        "sidelobe_peak_db": sidelobe_peak_db,
        "sidelobe_definition": "peak_db - max(pattern_db excluding peak index)",
    }


def _write_metrics(output_dir: Path, metrics: Dict[str, Any]) -> None:
    save_json(output_dir / "metrics.json", metrics)


def _write_progress(
    progress_path: Path,
    steps: list[str],
    step_index: int,
    status: str,
    error: str | None = None,
) -> None:
    total = len(steps)

thinking
**Planning optional scipy import**

I need to add support for importing MAT files with optional scipy dependency, so I'll check the pyproject configuration for handling this optional package.
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/pyproject.toml' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
[project]
name = "ris_sionna"
version = "0.1.0"
description = "Beginner-friendly Sionna RT baseline (28 GHz) with CLI, outputs, and optional dashboard"
readme = "README.md"
requires-python = ">=3.10,<3.13"
license = "MIT"

# Core runtime dependencies
# Note: sionna brings in TensorFlow and Sionna RT dependencies per official docs.
dependencies = [
  "sionna==1.2.1",
  "numpy==1.26.4",
  "matplotlib==3.10.8",
  "pyyaml==6.0.3",
  "rich==14.2.0",
]

[project.optional-dependencies]
# Visualization-only dashboard

thinking
**Checking extras for scipy in docs**

I'm searching existing documentation to see if "ris-lab" or a similar extra for scipy is already referenced, to decide on adding it as an optional dependency.
exec
/usr/bin/zsh -lc 'rg -n "scipy|MAT|npz|csv|validation" README.md docs app tests' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 7ms:
README.md:46:- 3D view of RF ray paths (if `ray_paths.csv` is available)
README.md:134:- `data/radio_map.npz` (path gain + derived metrics + cell centers)
README.md:135:- `data/radio_map.csv` (x, y, z, path_gain_db)
README.md:136:- `data/paths.csv` (order/type/length/delay/power + interactions list)
README.md:137:- `data/ray_paths.csv` and `data/ray_paths.npz` (ray segments for 3D view)
README.md:141:- `viewer/heatmap.json` and `viewer/heatmap.npz` (coverage overlay)
README.md:217:- Heatmap alignment fixed for rotated scenes; validation ongoing on larger meshes.
app/scene.py:23:MATERIAL_LIBRARY = {
app/scene.py:81:    props = MATERIAL_LIBRARY.get(name, MATERIAL_LIBRARY["concrete"])
app/scene.py:147:        props = MATERIAL_LIBRARY.get(name, MATERIAL_LIBRARY["concrete"])
app/plots.py:13:def _load_npz(path: Path) -> Dict[str, Any]:
app/plots.py:81:def plot_radio_map_from_npz(
app/plots.py:82:    npz_path: Path,
app/plots.py:88:    data = _load_npz(npz_path)
tests/test_ris_lab_reference.py:7:from app.ris.ris_lab import _load_reference_npz
tests/test_ris_lab_reference.py:11:    def test_load_reference_npz_pattern_db(self) -> None:
tests/test_ris_lab_reference.py:13:            path = Path(tmp_dir) / "ref.npz"
tests/test_ris_lab_reference.py:15:            theta, pattern, kind = _load_reference_npz(path)
tests/test_ris_lab_reference.py:21:    def test_load_reference_npz_missing_keys(self) -> None:
tests/test_ris_lab_reference.py:23:            path = Path(tmp_dir) / "ref.npz"

thinking
**Planning MAT loader integration**

I'm preparing to implement the MAT loader in ris_lab and update the README to document it, including adding scipy as an optional dependency under a new extras group like "ris-lab-mat". Next, I'll search existing docs to determine where to place these updates.
exec
/usr/bin/zsh -lc 'rg -n "RIS Lab|ris lab|ris" README.md docs' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 6ms:
README.md:194:ris:
README.md:210:- Consistent asset naming + metadata for multi-run comparisons
README.md:213:- RIS panel integration behind `ris.enabled`
README.md:222:- Use `ris.enabled: true` to add RIS objects without refactoring the core pipeline.
README.md:270:- There are community/workaround guides for getting OptiX running in WSL2 (use at your own risk). See Mitsuba’s WSL2 OptiX notes.
docs/trace_viewer.json:7472:{"args":{"context":{"domModifications":0,"firstContentfulPaint":0,"initialURL":"","interactionTimestamp":0,"mostRecentURL":"","paintedArea":0,"performanceTimelineNavigationId":0,"repaintedArea":0,"softNavContextId":1}},"cat":"loading","id2":{"local":"0x54"},"name":"SoftNavigationHeuristics::CreateNewContext","ph":"n","pid":51337,"tid":5926977,"ts":245621236420},
exec
/usr/bin/zsh -lc "sed -n '180,260p' /home/josh/Documents/Github/RIS_SIONNA/README.md" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
- Procedural: `scene.type: procedural` with `scene.procedural` (ground + boxes + street canyon preset)
 - 3D Viewer mesh: `scene.mesh: path/to/scene.glb|gltf|obj` (optional)
 - Proxy geometry: `scene.proxy` (ground + boxes) for quick 3D previews
 - Dashboard mesh overrides: drop `.glb/.gltf/.obj` into `scenes/` and pick it in the sidebar
 - Built-in mesh export: `scene.export_mesh: true` exports PLY meshes for the 3D viewer

Visualization controls:
- `render.enabled`, `render.samples`, `render.resolution` control the optical scene render.
- `visualization.ray_paths.max_paths` controls how many RF paths are exported for 3D view.
 - Viewer output saved to `outputs/<timestamp>/viewer/index.html`
- `runtime.vram_guard` auto-reduces rays/depth when GPU memory is tight.

All configs include a placeholder:
```yaml
ris:
  enabled: false
```

## Project Notes
For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.


thinking
**Planning minimal docs and tests for optional dependency**

I'm deciding to add a brief note about scipy as an optional dependency for MAT import, likely in the README under a small RIS Lab or Project Notes section to keep changes minimal. Also planning to add tests for MAT loading that skip if scipy is missing and verify CLI error messaging for missing scipy.
thinking
**Adding optional MAT loader with error handling and extras**

I'm implementing MAT import in validation using scipy.io.loadmat with a try-import that raises a clear RuntimeError if scipy is missing. I'll add a "mat" optional dependency in pyproject pinned to scipy 1.12.0 and extend validation to handle .mat files extracting expected keys robustly. The CLI should show an actionable error when scipy is absent.
exec
/usr/bin/zsh -lc "sed -n '1,200p' /home/josh/Documents/Github/RIS_SIONNA/app/cli.py" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
import argparse
import logging
import os
import socket
import subprocess
import sys
from pathlib import Path

from .io import find_latest_output_dir
from .plots import plot_radio_map_from_npz
from .simulate import run_simulation
from .utils.logging import setup_logging
from .utils.system import print_diagnose_info

logger = logging.getLogger(__name__)

def _pick_dashboard_port(preferred: int = 8501) -> int:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        try:


thinking
**Clarifying error handling for missing scipy**

Decided to raise RuntimeError with clear message in ris_lab when scipy is missing for .mat files, allowing CLI to show an actionable install message via exception text; planning tests that mock missing scipy to confirm proper error raising and messaging.
thinking
**Planning tests to simulate missing scipy import**

I'm preparing to monkeypatch builtins.__import__ to raise ImportError for scipy during tests, ensuring RuntimeError triggers when loading .mat files without scipy; I'll apply patches for ris_lab.py and test files, update README if needed, run pytest, and log all significant actions before committing.
exec
/usr/bin/zsh -lc "sed -n '1,200p' /home/josh/Documents/Github/RIS_SIONNA/tests/test_ris_lab_reference.py" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
import tempfile
import unittest
from pathlib import Path

import numpy as np

from app.ris.ris_lab import _load_reference_npz


class TestRisLabReference(unittest.TestCase):
    def test_load_reference_npz_pattern_db(self) -> None:
        with tempfile.TemporaryDirectory() as tmp_dir:
            path = Path(tmp_dir) / "ref.npz"
            np.savez(path, theta_deg=np.array([0.0, 5.0]), pattern_db=np.array([0.0, -3.0]))
            theta, pattern, kind = _load_reference_npz(path)

        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
        self.assertEqual(kind, "pattern_db")



thinking
**Planning unittest for missing import**

I'm outlining a unittest that mocks missing scipy to verify the loader raises before file checks, creating a dummy file in a temp directory to avoid file-not-found errors during import failure testing.
thinking
**Planning documentation for optional MAT support**

I'm preparing to update CLI help to mention MAT files and plan to document optional scipy dependency for MAT support in the README, adding a concise note about RIS Lab validation formats and the optional MAT extra.
exec
/usr/bin/zsh -lc "sed -n '1,160p' /home/josh/Documents/Github/RIS_SIONNA/docs/STATUS.md" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
# Simulator Status (Handoff)

## What’s implemented
- Omniverse-lite simulator: stdlib HTTP server + static frontend (`app/sim_server.py`, `app/sim_web/*`).
- Background job runner: submits `python -m app run --config <generated>` as a subprocess (`app/sim_jobs.py`).
- Viewer artifacts exported per run (`app/viewer.py`):
  - `viewer/scene_manifest.json`, `viewer/markers.json`, `viewer/paths.json`, `viewer/heatmap.json`.
- Path table CSV now includes order/type/path length/power/interaction list (`app/metrics.py`, `app/simulate.py`).
- Procedural scenes: registry + street canyon preset + material library (`app/scene.py`, `configs/procedural.yaml`).
- UI: run selector, scene source selector, job buttons, path table, stats, glossary, heatmap controls.
- Viewer UX: collapsible left-panel sections, top heatmap scale bar, keyboard navigation (WASD/QE) + right-drag pan.
- Alignment aids: guides toggle (off by default) and heatmap/mesh rotation defaults set to 0.
- Marker tools: randomize Tx/Rx button (avoids proxy boxes when available).
- Perf trace captured in `docs/trace_viewer.json`, summary in `docs/perf.md`.

## Known issues (needs work)
- UI still needs polish; more responsive layouts + better defaults needed.
- Randomized Tx/Rx avoids proxy boxes only; if a scene has no proxy geometry, points may still land inside mesh volume.
- New runs sometimes don’t load; UI now auto-loads newest completed run, but needs more validation.



thinking
**Planning docs and tests for MAT loader**

I'll add a minimal RIS Lab validation note to the README and update CLI help to mention MAT support. Also, I'll implement the new loader with optional scipy import and add tests covering both presence and absence of scipy, including simulating import failure to confirm proper error messaging.
thinking
**Defining MAT loader and README update**

I'm planning a MAT loader helper that imports scipy optionally, validates required keys, and raises clear errors if missing or scipy absent. I'll add a concise new README section about MAT support and extend the RIS Lab validation to handle .mat files accordingly.
file update
M /home/josh/Documents/Github/RIS_SIONNA/app/ris/ris_lab.py
@@ -215,2 +215,32 @@
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
@@ -419,4 +449,4 @@
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
@@ -424,4 +454,6 @@
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
apply_patch(auto_approved=true) exited 0 in 3ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/app/ris/ris_lab.py
file update:
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )

file update:
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )


thinking
**Updating CLI help to include MAT**
file update
M /home/josh/Documents/Github/RIS_SIONNA/app/cli.py
@@ -64,3 +64,3 @@
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
apply_patch(auto_approved=true) exited 0 in 4ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/app/cli.py
file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )

file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )



thinking
**Planning unittest additions**

I'm preparing to add unittest tests in test_ris_lab_reference.py, including conditional skipping if scipy is missing and mocking ImportError for scipy to verify error handling in the mat loader, using a temporary file to safely test missing scipy scenarios.
thinking
**Drafting positive test using scipy**

I'm drafting a test that creates a temporary .mat file using scipy's savemat inside the test method to avoid import issues, then calls the loader and verifies outputs, skipping the test if scipy isn't installed.
file update
M /home/josh/Documents/Github/RIS_SIONNA/tests/test_ris_lab_reference.py
@@ -2,2 +2,3 @@
 import unittest
+from unittest import mock
 from pathlib import Path
@@ -6,3 +7,9 @@
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
@@ -26 +33,29 @@
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")
apply_patch(auto_approved=true) exited 0 in 5ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/tests/test_ris_lab_reference.py
file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")

file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Adding optional dependency in pyproject**
file update
M /home/josh/Documents/Github/RIS_SIONNA/pyproject.toml
@@ -24,2 +24,5 @@
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
apply_patch(auto_approved=true) exited 0 in 6ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/pyproject.toml
file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")

file update:
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Planning README addition**

Planning to add a new "RIS Lab Reference Imports" section near "Project Notes" with details on optional MAT dependency and default CSV/NPZ support, plus mentioning CLI usage.
file update
M /home/josh/Documents/Github/RIS_SIONNA/README.md
@@ -197,2 +197,6 @@
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'`.
+
 ## Project Notes
apply_patch(auto_approved=true) exited 0 in 7ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/README.md
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..c1451a5d22bd2f77e6c0ee7a48783df3a618e32b
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'`.
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")

file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..c1451a5d22bd2f77e6c0ee7a48783df3a618e32b
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'`.
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Adding rationale to docs**

Planning to add a short sentence explaining that MATLAB support is optional to keep the base install light, clarifying the intent behind the design in the documentation.
file update
M /home/josh/Documents/Github/RIS_SIONNA/README.md
@@ -199,3 +199,3 @@
 - CSV and NPZ reference files are supported by default.
-- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'`.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
 
apply_patch(auto_approved=true) exited 0 in 7ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/README.md
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")

file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Planning post-change documentation and logging**

I noted the possibility to update docs/TROUBLESHOOTING and plan to add activity logging with ralph log after major code changes for better tracking.
exec
/usr/bin/zsh -lc 'ralph log "Implemented MAT reference loader with optional scipy dependency"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 88ms:
Using local templates: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Running tests for verification**
exec
/usr/bin/zsh -lc 'python -m pytest' in /home/josh/Documents/Github/RIS_SIONNA exited 127 in 2ms:
zsh:1: command not found: python
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Checking Python executable options**

I'm verifying if `./.venv/bin/python` exists to run tests there; if not, I'll fallback to `python3 -m pytest` since plain `python` is missing.
exec
/usr/bin/zsh -lc 'ls -la /home/josh/Documents/Github/RIS_SIONNA/.venv/bin/python' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
lrwxrwxrwx 1 josh josh 7 Jan 19 20:22 /home/josh/Documents/Github/RIS_SIONNA/.venv/bin/python -> python3
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Adjusting test command to use venv Python**
exec
/usr/bin/zsh -lc '/home/josh/Documents/Github/RIS_SIONNA/.venv/bin/python -m pytest' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 529ms:
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /home/josh/Documents/Github/RIS_SIONNA
configfile: pyproject.toml
collected 17 items

tests/test_alignment.py ..                                               [ 11%]
tests/test_ris_config.py ...                                             [ 29%]
tests/test_ris_core.py ......                                            [ 64%]
tests/test_ris_lab_pattern.py ..                                         [ 76%]
tests/test_ris_lab_reference.py ....                                     [100%]

============================== 17 passed in 0.36s ==============================
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Planning test logging**

I'm preparing to add logs after test execution to improve visibility into test outcomes.
exec
/usr/bin/zsh -lc 'ralph log "Ran tests: /home/josh/Documents/Github/RIS_SIONNA/.venv/bin/python -m pytest"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 88ms:
Using local templates: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Preparing for commit**

A major code change with tests is done and logging for the initial start attempt already exists. Next step is committing these changes after reviewing documentation updates and scheduling security, performance, and regression reviews later.
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.codex/skills/commit/SKILL.md' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
---
name: commit
description: Write conventional commit messages with type, scope, and subject when the user wants to commit changes or save work.
---

# Git Commit

Creates git commits following Conventional Commits format with proper type, scope, and subject.

## Quick Start

```bash
# 1. Stage changes
git add <files>  # or: git add -A

# 2. Create commit (branch commit format)
git commit -m "type(scope): subject

Body explaining HOW and WHY.
Reference: Task X.Y, Req N"
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Checking for uncommitted changes**
exec
/usr/bin/zsh -lc 'git status --porcelain' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
 M .agents/tasks/prd-ris-lab.json
 M .ralph/activity.log
 M .ralph/errors.log
 M .ralph/runs/run-20260120-175122-20544-iter-7.log
 M README.md
 M app/cli.py
 M app/ris/ris_lab.py
 M pyproject.toml
 M tests/test_ris_lab_reference.py
?? .ralph/.tmp/prompt-20260120-175122-20544-8.md
?? .ralph/.tmp/story-20260120-175122-20544-8.json
?? .ralph/.tmp/story-20260120-175122-20544-8.md
?? .ralph/runs/run-20260120-175122-20544-iter-7.md
?? .ralph/runs/run-20260120-175122-20544-iter-8.log
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Clarifying commit scope for unexpected file changes**

There's uncertainty about including unintended modifications in .agents/tasks/prd files since the instructions require committing all run-made changes, including logs, but suggest not reverting other edits; next, I'll check diffs to confirm changes and decide whether to include them in the commit.
thinking
**Reviewing commit contents and ignoring temp files**

I'm verifying which modified files originated during this run to include all required changes and keep a clean working tree while avoiding committing ephemeral temp files like those in .ralph/.tmp by checking .gitignore next.
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.gitignore' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
__pycache__/
*.pyc
.venv/
outputs/
.DS_Store
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Considering commit inclusion for generated temp files**

I'm weighing whether to commit .ralph/.tmp contents since they're generated and might not be necessary, but all run-made changes must be committed; I'll inspect diffs to verify if files like errors.log changed during this run before deciding.
exec
/usr/bin/zsh -lc 'git diff --stat' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 6ms:
 .agents/tasks/prd-ris-lab.json                   |  13 +-
 .ralph/activity.log                              |   6 +
 .ralph/errors.log                                |   1 +
 .ralph/runs/run-20260120-175122-20544-iter-7.log | 212 ++++++++++++++++++++++-
 README.md                                        |   4 +
 app/cli.py                                       |   2 +-
 app/ris/ris_lab.py                               |  38 +++-
 pyproject.toml                                   |   3 +
 tests/test_ris_lab_reference.py                  |  37 +++-
 9 files changed, 305 insertions(+), 11 deletions(-)
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Noticing unexpected PRD file changes**

A PRD JSON file under .agents/tasks is modified, likely by the system, though instructions forbid editing it knowingly; this may be an automatic status update, so I'll avoid committing changes to stay compliant, even if that leaves the working tree dirty.
thinking
**Checking origin of PRD file changes**

I'm verifying if the PRD modifications occurred before the current run since reverting or undoing changes not made is disallowed, aiming to understand whether the edits predate this iteration.
exec
/usr/bin/zsh -lc 'git diff /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks/prd-ris-lab.json' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
diff --git a/.agents/tasks/prd-ris-lab.json b/.agents/tasks/prd-ris-lab.json
index 10b8142..26af2bc 100644
--- a/.agents/tasks/prd-ris-lab.json
+++ b/.agents/tasks/prd-ris-lab.json
@@ -250,7 +250,7 @@
     {
       "id": "US-006",
       "title": "Add NPZ reference import support",
-      "status": "in_progress",
+      "status": "done",
       "dependsOn": [
         "US-005"
       ],
@@ -261,13 +261,13 @@
         "Negative case: missing keys cause a clear error listing expected keys"
       ],
       "startedAt": "2026-01-20T18:44:28.903291+00:00",
-      "completedAt": null,
-      "updatedAt": "2026-01-20T18:44:28.903299+00:00"
+      "completedAt": "2026-01-20T18:49:50.686520+00:00",
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Deciding on committing loop-updated status changes**

The PRD status was modified by the loop and not manually, so it's acceptable to commit this change to keep the working tree clean without violating the "do not edit" rule.
thinking
**Clarifying commit and progress log sequencing**

There's a conflict between committing code changes before appending the progress entry and the requirement that all changes, including progress logs, must be committed; the clean solution is to make an initial commit after code changes, append the progress entry referencing that commit hash, then make a second commit for the progress log update.
exec
/usr/bin/zsh -lc 'ls -la /home/josh/Documents/Github/RIS_SIONNA/.ralph/.tmp' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
total 152
drwxrwxr-x 2 josh josh 4096 Jan 20 18:49 .
drwxrwxr-x 4 josh josh 4096 Jan 20 18:20 ..
-rw-rw-r-- 1 josh josh  504 Jan 20 17:19 prd-prompt-20260120-171958-14900.md
-rw-rw-r-- 1 josh josh 2028 Jan 20 17:21 prd-prompt-20260120-172129-15202.md
-rw-rw-r-- 1 josh josh 5183 Jan 20 17:25 prd-prompt-20260120-172535-16265.md
-rw-rw-r-- 1 josh josh 7192 Jan 20 17:51 prompt-20260120-175122-20544-1.md
-rw-rw-r-- 1 josh josh 7171 Jan 20 17:57 prompt-20260120-175122-20544-2.md
-rw-rw-r-- 1 josh josh 7084 Jan 20 18:09 prompt-20260120-175122-20544-3.md
-rw-rw-r-- 1 josh josh 7121 Jan 20 18:22 prompt-20260120-175122-20544-4.md
-rw-rw-r-- 1 josh josh 7096 Jan 20 18:31 prompt-20260120-175122-20544-5.md
-rw-rw-r-- 1 josh josh 7050 Jan 20 18:38 prompt-20260120-175122-20544-6.md
-rw-rw-r-- 1 josh josh 6812 Jan 20 18:44 prompt-20260120-175122-20544-7.md
-rw-rw-r-- 1 josh josh 6868 Jan 20 18:49 prompt-20260120-175122-20544-8.md
-rw-rw-r-- 1 josh josh  176 Jan 20 17:51 story-20260120-175122-20544-1.json
-rw-rw-r-- 1 josh josh  767 Jan 20 17:51 story-20260120-175122-20544-1.md
-rw-rw-r-- 1 josh josh  182 Jan 20 17:57 story-20260120-175122-20544-2.json
-rw-rw-r-- 1 josh josh  734 Jan 20 17:57 story-20260120-175122-20544-2.md
-rw-rw-r-- 1 josh josh  182 Jan 20 18:09 story-20260120-175122-20544-3.json
-rw-rw-r-- 1 josh josh  645 Jan 20 18:09 story-20260120-175122-20544-3.md
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Deciding to commit new run logs and temp files**

The new untracked files in the .ralph/.tmp and .ralph/runs directories are likely expected artifacts from this workflow, so I'll include all these new and modified logs and prompt files in the next commit to keep the repo clean. I'll review security, performance, and regression concerns before finalizing the commit message.
thinking
**Finalizing commit strategy and message**

I confirmed all changes—including code, docs, tests, optional dependency updates, and logs—must be staged together before the first commit with a conventional message like `feat(validation): add MAT reference imports`. A second commit will capture progress log additions made afterward to keep history clear.
exec
/usr/bin/zsh -lc 'ls -la /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
total 2936
drwxrwxr-x 2 josh josh   4096 Jan 20 18:49 .
drwxrwxr-x 4 josh josh   4096 Jan 20 18:20 ..
-rw-rw-r-- 1 josh josh 101253 Jan 20 17:57 run-20260120-175122-20544-iter-1.log
-rw-rw-r-- 1 josh josh   1270 Jan 20 17:57 run-20260120-175122-20544-iter-1.md
-rw-rw-r-- 1 josh josh 552363 Jan 20 18:09 run-20260120-175122-20544-iter-2.log
-rw-rw-r-- 1 josh josh   1287 Jan 20 18:09 run-20260120-175122-20544-iter-2.md
-rw-rw-r-- 1 josh josh 773438 Jan 20 18:22 run-20260120-175122-20544-iter-3.log
-rw-rw-r-- 1 josh josh   1157 Jan 20 18:22 run-20260120-175122-20544-iter-3.md
-rw-rw-r-- 1 josh josh 819482 Jan 20 18:31 run-20260120-175122-20544-iter-4.log
-rw-rw-r-- 1 josh josh   1162 Jan 20 18:31 run-20260120-175122-20544-iter-4.md
-rw-rw-r-- 1 josh josh 258415 Jan 20 18:38 run-20260120-175122-20544-iter-5.log
-rw-rw-r-- 1 josh josh   1248 Jan 20 18:38 run-20260120-175122-20544-iter-5.md
-rw-rw-r-- 1 josh josh 101491 Jan 20 18:44 run-20260120-175122-20544-iter-6.log
-rw-rw-r-- 1 josh josh   1147 Jan 20 18:44 run-20260120-175122-20544-iter-6.md
-rw-rw-r-- 1 josh josh 155036 Jan 20 18:49 run-20260120-175122-20544-iter-7.log
-rw-rw-r-- 1 josh josh   1273 Jan 20 18:49 run-20260120-175122-20544-iter-7.md
-rw-rw-r-- 1 josh josh 173051 Jan 20 18:54 run-20260120-175122-20544-iter-8.log
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Checking previous run summary format**

I'm inspecting the iter-7.md file to understand the expected format for the run summary so I can create a minimal iter-8 summary accordingly.
exec
/usr/bin/zsh -lc 'cat /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-7.md' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
# Ralph Run Summary

- Run ID: 20260120-175122-20544
- Iteration: 7
- Mode: build
- Story: US-006: Add NPZ reference import support
- Started: 2026-01-20 18:44:28
- Ended: 2026-01-20 18:49:50
- Duration: 322s
- Status: success
- Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-7.log

## Git
- Head (before): 0319c6fad5adb10ed4289d42f67e749d5ce2db2d
- Head (after): ac9b9c6103766a684f5034c4615f6d268b4faa4d

### Commits
- ac9b9c6 chore(run-log): update iter-7 log
- 31b600f chore(run-log): update iter-7 log
- 81f7103 chore(run-log): update iter-7 log
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Considering run summary creation**

Noting prior runs created run summary files with commits and progress, it seems prudent to generate the current run summary to maintain consistency, even though instructions don't explicitly require it. I'll ensure no uncommitted changes remain before this.
thinking
**Planning dependency handling and logging updates**

I'm ensuring the CLI shows an actionable missing scipy message, considering catching that error to avoid stack traces while keeping other errors unchanged. I'll update README docs about the optional dependency and log any notable errors, including the prior python missing command issue, before running tests and reviewing code diffs for correctness.
exec
/usr/bin/zsh -lc 'git diff /home/josh/Documents/Github/RIS_SIONNA/app/ris/ris_lab.py' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9d..dbfe2b6 100644
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@ def _load_reference_npz(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Updating tests for diff**
exec
/usr/bin/zsh -lc 'git diff /home/josh/Documents/Github/RIS_SIONNA/tests/test_ris_lab_reference.py' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c0429..5f5326e 100644
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Deciding on run summary file creation**

Considering instructions and past runs, creating a run summary file seems expected for consistency, but it's not explicitly required and adds scope; leaning toward skipping it to avoid complexity.
thinking
**Confirming run summary file creation and progress logging**

Decided to create the run summary file after commits for consistency since instructions reference its path. Planning to record both verification commands with pass/fail in the progress entry and update logs after commits accordingly.
exec
/usr/bin/zsh -lc 'git diff /home/josh/Documents/Github/RIS_SIONNA/.ralph/errors.log' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
diff --git a/.ralph/errors.log b/.ralph/errors.log
index 05f4c9c..cb25632 100644
--- a/.ralph/errors.log
+++ b/.ralph/errors.log
@@ -8,3 +8,4 @@
 [2026-01-20 18:31:34] ITERATION 4 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-4.md
 [2026-01-20 18:38:12] ITERATION 5 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-5.md
 [2026-01-20 18:44:26] ITERATION 6 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-6.md
+[2026-01-20 18:49:50] ITERATION 7 left uncommitted changes; review run summary at /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-7.md
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Planning run summary creation**

The errors log is updated and must be committed to keep a clean tree; the new run summary for iteration 8 doesn't exist yet but is expected by progress tracking, so I'll create it after committing, modeled on the previous iteration's summary.
thinking
**Confirming run summary details**

The run summary file for iteration 8 is missing but should be created to stay consistent and record the outcome; I'll extract start and end times from the run log header if possible for accuracy before crafting the summary.
exec
/usr/bin/zsh -lc 'head -n 20 /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.log' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
OpenAI Codex v0.87.0 (research preview)
--------
workdir: /home/josh/Documents/Github/RIS_SIONNA
model: gpt-5.2-codex
provider: openai
approval: never
sandbox: danger-full-access
reasoning effort: none
reasoning summaries: auto
session id: 019bdcbd-ec20-77a0-8fe9-f12322126705
--------
user
# Build

You are an autonomous coding agent. Your task is to complete the work for exactly one story and record the outcome.

## Paths
- PRD: /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks/prd-ris-lab.json
- AGENTS (optional): /home/josh/Documents/Github/RIS_SIONNA/AGENTS.md
- Progress Log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Reviewing code changes before commit**

I completed a security, performance, and regression review on the recent changes and found no major issues; after staging everything, I'll proceed to commit and then update the progress log accordingly.
thinking
**Staging all changes for commit**
exec
/usr/bin/zsh -lc 'git add -A' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 9ms:

file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Committing with detailed message**

Preparing a commit using the "validation" scope and including a body explaining the optional nature of the MAT dependency and testing extensions.
exec
/usr/bin/zsh -lc 'git commit -m "feat(validation): add MAT reference imports

- load MAT references via optional scipy extra
- extend validation CLI/docs to mention MAT support
- add tests for MAT import behavior"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 10ms:
[linux 45cba3f] feat(validation): add MAT reference imports
 14 files changed, 5774 insertions(+), 11 deletions(-)
 create mode 100644 .ralph/.tmp/prompt-20260120-175122-20544-8.md
 create mode 100644 .ralph/.tmp/story-20260120-175122-20544-8.json
 create mode 100644 .ralph/.tmp/story-20260120-175122-20544-8.md
 create mode 100644 .ralph/runs/run-20260120-175122-20544-iter-7.md
 create mode 100644 .ralph/runs/run-20260120-175122-20544-iter-8.log
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Verifying clean status**

I'm checking the repository to confirm a clean status after a commit that included 14 changed files and a new untracked file was added.
exec
/usr/bin/zsh -lc 'git status --porcelain' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
 M .ralph/runs/run-20260120-175122-20544-iter-8.log
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Preparing initial commit and progress entry**

Planning to capture the commit hash and subject now before adding the progress entry, following instructions to run `git show -s` right after the first commit.
exec
/usr/bin/zsh -lc 'git show -s --format="%h %s" HEAD' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
45cba3f feat(validation): add MAT reference imports
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Appending progress entry with current date**

I'm preparing to append a properly formatted progress entry with the current date/time to the progress log after the latest commit. I'll handle staging modifications to the run log separately after updating the progress entry.
exec
/usr/bin/zsh -lc 'date "+%Y-%m-%d %H:%M"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:
2026-01-20 18:56
file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Consolidating session ID and file changes**

Decided to use the available session ID from the run log header to track the thread. Planning to list both failed and successful verification commands plus a comprehensive list of changed files from git, covering code, logs, and metadata. Still clarifying when exactly to record post-commit clean status relative to second commit and progress entry.
thinking
**Finalizing progress entry timing and content**

Decided the progress entry will reference the first commit hash and include a "Post-commit status: clean" after the second commit for clarity. The file list will include all changed files, even the progress log itself. Planning to append the entry using a heredoc to ensure proper formatting and include concise learnings like venv usage and dependency notes.
exec
/usr/bin/zsh -lc "cat <<'EOF' >> /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md
## [2026-01-20 18:56] - US-007: Add MAT reference import (stretch)
Thread: 019bdcbd-ec20-77a0-8fe9-f12322126705
Run: 20260120-175122-20544 (iteration 8)
Run log: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.log
Run summary: /home/josh/Documents/Github/RIS_SIONNA/.ralph/runs/run-20260120-175122-20544-iter-8.md
- Guardrails reviewed: yes
- No-commit run: false
- Commit: 45cba3f feat(validation): add MAT reference imports
- Post-commit status: clean
- Verification:
  - Command: python -m pytest -> FAIL (python not found)
  - Command: /home/josh/Documents/Github/RIS_SIONNA/.venv/bin/python -m pytest -> PASS
- Files changed:
  - .agents/tasks/prd-ris-lab.json
  - .ralph/.tmp/prompt-20260120-175122-20544-8.md
  - .ralph/.tmp/story-20260120-175122-20544-8.json
  - .ralph/.tmp/story-20260120-175122-20544-8.md
  - .ralph/activity.log
  - .ralph/errors.log
  - .ralph/progress.md
  - .ralph/runs/run-20260120-175122-20544-iter-7.log
  - .ralph/runs/run-20260120-175122-20544-iter-7.md
  - .ralph/runs/run-20260120-175122-20544-iter-8.log
  - README.md
  - app/cli.py
  - app/ris/ris_lab.py
  - pyproject.toml
  - tests/test_ris_lab_reference.py
- What was implemented
- **Learnings for future iterations:**
  - Patterns discovered
  - Gotchas encountered
  - Useful context
---
EOF" in /home/josh/Documents/Github/RIS_SIONNA succeeded in 3ms:

file update:
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Filling missing implementation and learning details**

I'm updating the "What was implemented" and "Learnings" sections with concise summaries about adding the MAT reference loader, CLI/help and README updates, tests for scipy imports, and validation changes, plus test environment notes and import mocking strategies; I'll apply these changes to progress.md using a patch.
file update
M /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md
@@ -256,7 +256,7 @@
   - tests/test_ris_lab_reference.py
-- What was implemented
+- What was implemented: added MAT reference loading via optional scipy, extended validation to accept .mat, updated CLI/docs, and added MAT import tests.
 - **Learnings for future iterations:**
-  - Patterns discovered
-  - Gotchas encountered
-  - Useful context
+  - Patterns discovered: MAT imports fit the same theta/pattern contract as CSV/NPZ after normalization.
+  - Gotchas encountered: `python` may not be on PATH; use the repo venv for pytest.
+  - Useful context: mock `__import__` to assert actionable missing-scipy errors.
 ---
apply_patch(auto_approved=true) exited 0 in 8ms:
Success. Updated the following files:
M /home/josh/Documents/Github/RIS_SIONNA/.ralph/progress.md
file update:
diff --git a/.ralph/progress.md b/.ralph/progress.md
index 1d309332c23bfbd273a3b60af7e014ac9caf326b..408684bec18efec30520447a00390f8458118a45
--- a/.ralph/progress.md
+++ b/.ralph/progress.md
@@ -254,9 +254,9 @@
   - app/ris/ris_lab.py
   - pyproject.toml
   - tests/test_ris_lab_reference.py
-- What was implemented
+- What was implemented: added MAT reference loading via optional scipy, extended validation to accept .mat, updated CLI/docs, and added MAT import tests.
 - **Learnings for future iterations:**
-  - Patterns discovered
-  - Gotchas encountered
-  - Useful context
+  - Patterns discovered: MAT imports fit the same theta/pattern contract as CSV/NPZ after normalization.
+  - Gotchas encountered: `python` may not be on PATH; use the repo venv for pytest.
+  - Useful context: mock `__import__` to assert actionable missing-scipy errors.
 ---
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")

file update:
diff --git a/.ralph/progress.md b/.ralph/progress.md
index 1d309332c23bfbd273a3b60af7e014ac9caf326b..408684bec18efec30520447a00390f8458118a45
--- a/.ralph/progress.md
+++ b/.ralph/progress.md
@@ -254,9 +254,9 @@
   - app/ris/ris_lab.py
   - pyproject.toml
   - tests/test_ris_lab_reference.py
-- What was implemented
+- What was implemented: added MAT reference loading via optional scipy, extended validation to accept .mat, updated CLI/docs, and added MAT import tests.
 - **Learnings for future iterations:**
-  - Patterns discovered
-  - Gotchas encountered
-  - Useful context
+  - Patterns discovered: MAT imports fit the same theta/pattern contract as CSV/NPZ after normalization.
+  - Gotchas encountered: `python` may not be on PATH; use the repo venv for pytest.
+  - Useful context: mock `__import__` to assert actionable missing-scipy errors.
 ---
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")



thinking
**Deciding against creating run summary file**

The run summary file is referenced but not required and missing; to avoid inaccurate timestamps or misleading info, I’ll skip creating it for now.
thinking
**Confirming to skip run summary creation**

Progress log references the missing run summary, but to avoid inaccurate timing data and since it's not required, I’ll skip creating it and proceed to log the progress update instead.
exec
/usr/bin/zsh -lc 'ralph log "Updated progress log for US-007"' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 88ms:
Using local templates: /home/josh/Documents/Github/RIS_SIONNA/.agents/ralph
file update:
diff --git a/.ralph/progress.md b/.ralph/progress.md
index 1d309332c23bfbd273a3b60af7e014ac9caf326b..408684bec18efec30520447a00390f8458118a45
--- a/.ralph/progress.md
+++ b/.ralph/progress.md
@@ -254,9 +254,9 @@
   - app/ris/ris_lab.py
   - pyproject.toml
   - tests/test_ris_lab_reference.py
-- What was implemented
+- What was implemented: added MAT reference loading via optional scipy, extended validation to accept .mat, updated CLI/docs, and added MAT import tests.
 - **Learnings for future iterations:**
-  - Patterns discovered
-  - Gotchas encountered
-  - Useful context
+  - Patterns discovered: MAT imports fit the same theta/pattern contract as CSV/NPZ after normalization.
+  - Gotchas encountered: `python` may not be on PATH; use the repo venv for pytest.
+  - Useful context: mock `__import__` to assert actionable missing-scipy errors.
 ---
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Preparing commit of progress logs**

I'm gathering the updated progress log files and any other modifications after the initial commit, then checking git status to confirm changes before committing.
exec
/usr/bin/zsh -lc 'git status --porcelain' in /home/josh/Documents/Github/RIS_SIONNA succeeded in 4ms:
 M .ralph/activity.log
 M .ralph/progress.md
 M .ralph/runs/run-20260120-175122-20544-iter-8.log
file update:
diff --git a/.ralph/progress.md b/.ralph/progress.md
index 1d309332c23bfbd273a3b60af7e014ac9caf326b..408684bec18efec30520447a00390f8458118a45
--- a/.ralph/progress.md
+++ b/.ralph/progress.md
@@ -254,9 +254,9 @@
   - app/ris/ris_lab.py
   - pyproject.toml
   - tests/test_ris_lab_reference.py
-- What was implemented
+- What was implemented: added MAT reference loading via optional scipy, extended validation to accept .mat, updated CLI/docs, and added MAT import tests.
 - **Learnings for future iterations:**
-  - Patterns discovered
-  - Gotchas encountered
-  - Useful context
+  - Patterns discovered: MAT imports fit the same theta/pattern contract as CSV/NPZ after normalization.
+  - Gotchas encountered: `python` may not be on PATH; use the repo venv for pytest.
+  - Useful context: mock `__import__` to assert actionable missing-scipy errors.
 ---
diff --git a/README.md b/README.md
index 52fba4c7f309fd7df585176d6bd40883960edf2c..249033259b1806aa9b9f8ec992898954686661ba
--- a/README.md
+++ b/README.md
@@ -195,6 +195,10 @@
   enabled: false
 ```
 
+## RIS Lab Reference Imports
+- CSV and NPZ reference files are supported by default.
+- MAT reference files require the optional dependency: `pip install 'ris_sionna[mat]'` (keeps the base CLI lightweight while enabling MATLAB exports).
+
 ## Project Notes
 For operational notes, known quirks, and handoff context, see `PROJECT_CONTEXT.md`.
 Performance trace notes for the simulator viewer: `docs/perf.md`.
diff --git a/app/cli.py b/app/cli.py
index a9a5995d795b5f1caaea3ba2f6963231cd4bb30c..4fcb23a2714c6a2a36901b75160101d3b87210cb
--- a/app/cli.py
+++ b/app/cli.py
@@ -62,7 +62,7 @@
     ris_validate = ris_subparsers.add_parser("validate", help="Validate RIS Lab")
     ris_validate.add_argument("--config", required=True, help="Path to RIS Lab YAML config")
     ris_validate.add_argument(
-        "--ref", required=True, help="Path to reference CSV or NPZ file"
+        "--ref", required=True, help="Path to reference CSV, NPZ, or MAT file"
     )
 
     return parser.parse_args()
diff --git a/app/ris/ris_lab.py b/app/ris/ris_lab.py
index b02ee9da6a80ac30900b98e9b530ceb1fd70bd85..dbfe2b6af873a590f981b695d31805cedba281d1
--- a/app/ris/ris_lab.py
+++ b/app/ris/ris_lab.py
@@ -213,6 +213,36 @@
     return theta, pattern, pattern_kind
 
 
+def _load_reference_mat(path: Path) -> Tuple[np.ndarray, np.ndarray, str]:
+    try:
+        from scipy.io import loadmat
+    except Exception as exc:
+        raise RuntimeError(
+            "scipy is required for MAT reference imports. "
+            "Install with: pip install 'ris_sionna[mat]'"
+        ) from exc
+
+    data = loadmat(path)
+    keys = {key for key in data.keys() if not key.startswith("__")}
+    missing = []
+    if "theta_deg" not in keys:
+        missing.append("theta_deg")
+    if "pattern_db" not in keys and "pattern_linear" not in keys:
+        missing.append("pattern_db or pattern_linear")
+    if missing:
+        key_list = ", ".join(sorted(keys)) if keys else "(none)"
+        missing_list = ", ".join(missing)
+        raise ValueError(
+            "Reference MAT missing required key(s): "
+            f"{missing_list}. Expected keys: theta_deg + (pattern_db or pattern_linear). "
+            f"Found keys: {key_list}"
+        )
+    pattern_kind = "pattern_db" if "pattern_db" in keys else "pattern_linear"
+    theta = np.asarray(data["theta_deg"], dtype=float).reshape(-1)
+    pattern = np.asarray(data[pattern_kind], dtype=float).reshape(-1)
+    return theta, pattern, pattern_kind
+
+
 def _validate_theta_pattern_lengths(
     theta_deg: np.ndarray, pattern: np.ndarray, pattern_name: str
 ) -> None:
@@ -417,13 +447,15 @@
         if not ref_path.exists():
             raise FileNotFoundError(f"Reference file not found: {ref_path}")
         suffix = ref_path.suffix.lower()
-        if suffix not in {".csv", ".npz"}:
-            raise ValueError("Reference file must be a CSV or NPZ")
+        if suffix not in {".csv", ".npz", ".mat"}:
+            raise ValueError("Reference file must be a CSV, NPZ, or MAT")
 
         if suffix == ".csv":
             theta_ref, ref_vals, ref_kind = _load_reference_csv(ref_path)
+        elif suffix == ".npz":
+            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
         else:
-            theta_ref, ref_vals, ref_kind = _load_reference_npz(ref_path)
+            theta_ref, ref_vals, ref_kind = _load_reference_mat(ref_path)
         sim_linear = _compute_array_response(
             geometry.centers, phase_map, geometry.frame, wavelength, theta_ref
         )
diff --git a/pyproject.toml b/pyproject.toml
index d57fc1ac59e46ad565c1d3a6a243cb07559a4803..f8cbe3ddd9bad5005c459352d4762c41884c1b59
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -22,6 +22,9 @@
 dashboard = [
   "streamlit==1.53.0",
 ]
+mat = [
+  "scipy==1.12.0",
+]
 
 [build-system]
 requires = ["setuptools>=77.0.0"]
diff --git a/tests/test_ris_lab_reference.py b/tests/test_ris_lab_reference.py
index d0c04292906ea90de23134269ade07c8d0edd7f8..5f5326e4f68a2ed58675af7bd989f4e201ce3e07
--- a/tests/test_ris_lab_reference.py
+++ b/tests/test_ris_lab_reference.py
@@ -1,10 +1,17 @@
 import tempfile
 import unittest
+from unittest import mock
 from pathlib import Path
 
 import numpy as np
 
-from app.ris.ris_lab import _load_reference_npz
+from app.ris.ris_lab import _load_reference_mat, _load_reference_npz
+
+try:
+    import scipy  # noqa: F401
+    SCIPY_AVAILABLE = True
+except Exception:
+    SCIPY_AVAILABLE = False
 
 
 class TestRisLabReference(unittest.TestCase):
@@ -24,3 +31,31 @@
             np.savez(path, pattern_db=np.array([0.0, -3.0]))
             with self.assertRaisesRegex(ValueError, r"Expected keys: theta_deg \+ \(pattern_db or pattern_linear\)"):
                 _load_reference_npz(path)
+
+    def test_load_reference_mat_missing_scipy(self) -> None:
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            path.write_bytes(b"")
+            original_import = __import__
+
+            def _blocked_import(name, *args, **kwargs):
+                if name.startswith("scipy"):
+                    raise ImportError("No module named scipy")
+                return original_import(name, *args, **kwargs)
+
+            with mock.patch("builtins.__import__", side_effect=_blocked_import):
+                with self.assertRaisesRegex(RuntimeError, r"scipy is required for MAT reference imports"):
+                    _load_reference_mat(path)
+
+    @unittest.skipUnless(SCIPY_AVAILABLE, "scipy not installed")
+    def test_load_reference_mat_pattern_db(self) -> None:
+        from scipy.io import savemat
+
+        with tempfile.TemporaryDirectory() as tmp_dir:
+            path = Path(tmp_dir) / "ref.mat"
+            savemat(path, {"theta_deg": np.array([0.0, 5.0]), "pattern_db": np.array([0.0, -3.0])})
+            theta, pattern, kind = _load_reference_mat(path)
+
+        np.testing.assert_allclose(theta, np.array([0.0, 5.0]))
+        np.testing.assert_allclose(pattern, np.array([0.0, -3.0]))
+        self.assertEqual(kind, "pattern_db")


thinking
**Staging all changes for commit**
exec
/usr/bin/zsh -lc 'git add -A' in /home/josh/Documents/Github/RIS_SIONNA