<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RIS_SIONNA Omniverse-lite Simulator</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">RIS</div>
        <div>
          <div class="brand-title">Omniverse-lite Simulator</div>
          <div class="brand-sub">Sionna RT · 28 GHz · Low VRAM mode</div>
        </div>
      </div>
      <div class="top-controls">
        <select id="runSelect"></select>
        <button id="refreshRuns">Refresh</button>
        <button id="topDown">Top-down</button>
        <button id="snapshot">Take Snapshot</button>
      </div>
    </header>

    <main class="main">
      <div class="main-tab-strip" id="mainTabStrip">
        <button class="main-tab-button is-active" data-main-tab="sim" type="button">Simulation</button>
        <button class="main-tab-button" data-main-tab="ris" type="button">RIS Lab</button>
      </div>

      <div class="main-tab-panel is-active" data-main-tab="sim">
        <div class="layout">
          <section class="panel left">
        <details class="panel-section" open>
          <summary>Scene Controls</summary>
          <div class="panel-section-body">
            <div class="field">
              <label>Mesh rotation (deg) <span id="meshRotationLabel">0</span></label>
              <input id="meshRotation" type="range" min="-180" max="180" value="0" step="1" />
            </div>
            <div class="field">
              <label>Scene source (for jobs)</label>
              <select id="sceneRunSelect"></select>
            </div>
            <div class="field">
              <label>Viewer mesh (config)</label>
              <select id="meshRunSelect"></select>
            </div>
            <div class="field">
              <label>Run profile</label>
              <select id="runProfile">
                <option value="cpu_only">CPU Only</option>
                <option value="gpu_low">GPU Low</option>
                <option value="gpu_medium">GPU Medium</option>
                <option value="gpu_high">GPU High</option>
                <option value="custom">Custom</option>
              </select>
            </div>
            <details class="panel-section" id="customOverridesSection">
              <summary>Custom Overrides</summary>
              <div class="panel-section-body">
                <div class="help-text">No hard limits; higher values increase runtime and VRAM usage. Suggested maxima target RTX 4070 Ti 12GB.</div>
                <div class="field">
                  <label>Backend</label>
                  <select id="customBackend">
                    <option value="cpu">CPU only</option>
                    <option value="gpu">Prefer GPU</option>
                  </select>
                  <div class="help-text">CPU mode is safest on laptops. GPU mode uses CUDA/OptiX when available.</div>
                </div>
                <div class="field-grid">
                  <div>
                    <label>Max depth</label>
                    <input id="customMaxDepth" type="number" step="1" min="1" />
                    <div class="help-text">Suggested max: 6 (higher is expensive and rarely adds value).</div>
                  </div>
                  <div>
                    <label>Samples per src</label>
                    <input id="customSamplesPerSrc" type="number" step="1000" min="1000" />
                    <div class="help-text">Suggested max: 2,000,000 (GPU high profile ceiling).</div>
                  </div>
                  <div>
                    <label>Max paths per src</label>
                    <input id="customMaxPathsPerSrc" type="number" step="1000" min="1000" />
                    <div class="help-text">Suggested max: 2,000,000 (GPU high profile ceiling).</div>
                  </div>
                </div>
                <div class="field-grid">
                  <label class="toggle">
                    <input id="radioMapAuto" type="checkbox" />
                    Auto size (scene bbox)
                  </label>
                </div>
                <div class="field-grid">
                  <div>
                    <label>Auto padding (m)</label>
                    <input id="radioMapPadding" type="number" step="1" />
                  </div>
                  <div>
                    <label>Cell size (x y)</label>
                    <div class="dual-inputs">
                      <input id="radioMapCellX" type="number" step="0.5" />
                      <input id="radioMapCellY" type="number" step="0.5" />
                    </div>
                  </div>
                  <div>
                    <label>Samples per Tx</label>
                    <input id="customSamplesPerTx" type="number" step="10000" min="1000" />
                    <div class="help-text">Suggested max: 4,000,000 (GPU high profile ceiling).</div>
                  </div>
                </div>
                <div class="field-grid">
                  <div>
                    <label>Map size (x y)</label>
                    <div class="dual-inputs">
                      <input id="radioMapSizeX" type="number" step="1" />
                      <input id="radioMapSizeY" type="number" step="1" />
                    </div>
                  </div>
                  <div>
                    <label>Map center (x y z)</label>
                    <div class="triple">
                      <input id="radioMapCenterX" type="number" step="0.5" />
                      <input id="radioMapCenterY" type="number" step="0.5" />
                      <input id="radioMapCenterZ" type="number" step="0.5" />
                    </div>
                  </div>
                </div>
              </div>
            </details>

            <details class="panel-section" open>
              <summary>RIS Objects</summary>
              <div class="panel-section-body">
                <label class="toggle">
                  <input id="simRisEnabled" type="checkbox" />
                  Enable RIS objects for this run
                </label>
                <div class="help-text">Drag RIS markers in 3D when “Drag markers” is enabled. Hold Shift while dragging to rotate about Z.</div>
                <div id="risList" class="ris-list"></div>
                <div class="job-buttons">
                  <button id="addRis" type="button">Add RIS</button>
                  <button id="debugRis" type="button">Debug Boost + Center Map</button>
                </div>
              </div>
            </details>

            <div class="field">
              <label>Run stats</label>
              <div class="run-stats" id="runStats">No run loaded.</div>
            </div>

            <div class="field-grid">
              <div>
                <label>Tx Position (x y z)</label>
                <div class="triple">
                  <input id="txX" type="number" step="0.1" />
                  <input id="txY" type="number" step="0.1" />
                  <input id="txZ" type="number" step="0.1" />
                </div>
              </div>
              <div>
                <label>Tx Look-at (x y z)</label>
                <div class="triple">
                  <input id="txLookX" type="number" step="0.1" />
                  <input id="txLookY" type="number" step="0.1" />
                  <input id="txLookZ" type="number" step="0.1" />
                </div>
              </div>
              <div>
                <label>Tx Yaw (deg)</label>
                <input id="txYawDeg" type="number" step="1" />
              </div>
              <div>
                <label>Rx Position (x y z)</label>
                <div class="triple">
                  <input id="rxX" type="number" step="0.1" />
                  <input id="rxY" type="number" step="0.1" />
                  <input id="rxZ" type="number" step="0.1" />
                </div>
              </div>
              <div>
                <label>Tx Power (dBm)</label>
                <input id="txPowerDbm" type="number" step="0.5" />
              </div>
              <div>
                <label>Tx Pattern</label>
                <select id="txPattern">
                  <option value="iso">iso</option>
                  <option value="dipole">dipole</option>
                  <option value="hw_dipole">hw_dipole</option>
                  <option value="tr38901">tr38901</option>
                </select>
              </div>
              <div>
                <label>Tx Polarization</label>
                <select id="txPolarization">
                  <option value="V">V</option>
                  <option value="H">H</option>
                  <option value="VH">VH</option>
                  <option value="cross">cross</option>
                </select>
              </div>
              <label class="toggle">
                <input id="showTxDirection" type="checkbox" />
                Show Tx direction
              </label>
              <button id="applyMarkers">Apply Markers</button>
              <button id="randomizeMarkers" type="button">Randomize Tx/Rx</button>
              <label class="toggle">
                <input id="dragMarkers" type="checkbox" />
                Drag markers in 3D
              </label>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Run</summary>
          <div class="panel-section-body">
            <div class="job-buttons">
              <button id="runSim">Run Simulation</button>
            </div>

            <div class="job-status">
              <h3>Job Status</h3>
              <div id="jobList"></div>
            </div>
          </div>
        </details>

        <details class="panel-section">
          <summary>Radio Map</summary>
          <div class="panel-section-body">
            <div class="field-grid">
              <div>
                <label>Plot style</label>
                <select id="radioMapPlotStyle">
                  <option value="heatmap">Heatmap (custom)</option>
                  <option value="sionna">Sionna (standard)</option>
                </select>
              </div>
              <div>
                <label>Sionna metric</label>
                <select id="radioMapPlotMetric">
                  <option value="path_gain">path_gain</option>
                  <option value="rss">rss</option>
                  <option value="sinr">sinr</option>
                </select>
              </div>
              <label class="toggle">
                <input id="radioMapDiffRis" type="checkbox" />
                RIS diff map (RIS vs no-RIS)
              </label>
            </div>
            <div class="field-grid">
              <label class="toggle">
                <input id="radioMapPlotShowTx" type="checkbox" checked />
                Show Tx (Sionna)
              </label>
              <label class="toggle">
                <input id="radioMapPlotShowRx" type="checkbox" />
                Show Rx (Sionna)
              </label>
              <label class="toggle">
                <input id="radioMapPlotShowRis" type="checkbox" />
                Show RIS (Sionna)
              </label>
            </div>
            <div class="field-grid">
              <div>
                <label>Diff baseline run</label>
                <select id="radioMapDiffRun"></select>
              </div>
              <label class="toggle">
                <input id="radioMapDiffToggle" type="checkbox" />
                Show diff (current - baseline)
              </label>
            </div>
            <div class="field">
              <label>Rotation (deg) <span id="heatmapRotationLabel">0</span></label>
              <input id="heatmapRotation" type="range" min="-180" max="180" value="0" step="1" />
            </div>
            <div class="field">
              <label>Min level (dBm) <span id="heatmapMinLabel"></span></label>
              <input id="heatmapMin" type="range" min="-200" max="200" value="0" />
            </div>
            <div class="field">
              <label>Max level (dBm) <span id="heatmapMaxLabel"></span></label>
              <input id="heatmapMax" type="range" min="-200" max="200" value="100" />
            </div>
            <div class="field">
              <label>Heatmap scale (dBm)</label>
              <div class="dual-inputs">
                <input id="heatmapMinInput" type="number" step="1" />
                <input id="heatmapMaxInput" type="number" step="1" />
              </div>
            </div>
            <div class="field">
              <label>Radio map preview</label>
              <select id="radioMapPreviewSelect"></select>
            </div>
            <div class="field">
              <img id="radioMapPreviewImage" alt="Radio map preview" />
            </div>

            <details class="glossary">
              <summary>Glossary</summary>
              <div class="glossary-item"><strong>Run selector</strong> choose which saved output to load in the viewer.
              </div>
              <div class="glossary-item"><strong>Scene source</strong> pick a prior run's scene for new jobs.</div>
              <div class="glossary-item"><strong>Viewer mesh source</strong> swap which run's mesh is displayed in the 3D viewer.</div>
              <div class="glossary-item"><strong>Refresh</strong> reloads the run list from disk.</div>
              <div class="glossary-item"><strong>Top-down</strong> snaps camera to overhead view.</div>
              <div class="glossary-item"><strong>Take Snapshot</strong> exports current 3D view to PNG.</div>
              <div class="glossary-item"><strong>Apply Markers</strong> updates Tx/Rx positions used for jobs.</div>
              <div class="glossary-item"><strong>Drag markers in 3D</strong> drag Tx/Rx dots on the ground plane.</div>
              <div class="glossary-item"><strong>Run Profile</strong> chooses CPU-only or GPU presets (low/medium/high).</div>
              <div class="glossary-item"><strong>Run Simulation</strong> executes the full pipeline for the selected profile.</div>
              <div class="glossary-item"><strong>Custom Overrides</strong> unlocks manual tuning for simulation + radio map.</div>
              <div class="glossary-item"><strong>Geometry</strong> toggles the scene mesh/proxy.</div>
              <div class="glossary-item"><strong>Tx/Rx</strong> toggles transmitter/receiver markers.</div>
              <div class="glossary-item"><strong>Ray Paths</strong> toggles RF paths polylines.</div>
              <div class="glossary-item"><strong>Heatmap</strong> shows Rx power (dBm) across the grid.</div>
              <div class="glossary-item"><strong>Run stats</strong> shows key metrics from the loaded run.</div>
              <div class="glossary-item"><strong>Min/Max level</strong> adjusts heatmap contrast range.</div>
              <div class="glossary-item"><strong>Navigation</strong> right-drag pans, scroll zooms, WASD/QE nudge.</div>
            </details>
          </div>
        </details>
      </section>

      <section class="viewer">
        <div id="viewerCanvas"></div>
        <div class="viewer-overlay viewer-overlay-top">
          <div class="heatmap-scale is-hidden" id="heatmapScale">
            <div class="heatmap-scale-title">Heatmap (dBm)</div>
            <div class="heatmap-scale-bar"></div>
            <div class="heatmap-scale-labels">
              <span id="heatmapScaleMin">--</span>
              <span id="heatmapScaleMax">--</span>
            </div>
          </div>
          <div class="layer-toggle">
            <label><input id="toggleGeometry" type="checkbox" checked /> Geometry</label>
            <label><input id="toggleMarkers" type="checkbox" checked /> Tx/Rx</label>
            <label><input id="toggleRays" type="checkbox" checked /> Ray Paths</label>
            <label><input id="toggleHeatmap" type="checkbox" /> Heatmap</label>
            <label><input id="toggleGuides" type="checkbox" /> Guides</label>
            <label><input id="toggleRisFocus" type="checkbox" /> RIS Focus</label>
          </div>
        </div>
        <div class="viewer-overlay viewer-overlay-bottom">
          <div class="viewer-meta" id="viewerMeta">Ready</div>
        </div>
      </section>

      <section class="panel right">
        <h2>Path Table</h2>
        <div class="path-stats" id="pathStats"></div>
        <div class="field">
          <label>Filter by type</label>
          <select id="pathTypeFilter">
            <option value="all">all</option>
          </select>
        </div>
        <div class="field">
          <label>Max order</label>
          <input id="pathOrderFilter" type="number" min="0" step="1" value="99" />
        </div>
        <div class="path-table">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Type</th>
                <th>Order</th>
                <th>Length (m)</th>
                <th>Power (dB)</th>
              </tr>
            </thead>
            <tbody id="pathTableBody"></tbody>
          </table>
        </div>
      </section>
    </div>
  </div>

  <div class="main-tab-panel" data-main-tab="ris">
    <div class="ris-layout">
      <section class="panel ris-panel">
        <details class="panel-section" open>
          <summary>RIS Config</summary>
          <div class="panel-section-body">
            <div class="field">
              <label>Config source</label>
              <select id="risConfigSource">
                <option value="builder">Builder</option>
                <option value="file">Config file</option>
              </select>
            </div>
            <div class="field ris-config-file">
              <label>Config path</label>
              <input id="risConfigPath" type="text" placeholder="configs/ris/steer_1bit.yaml" />
              <div class="help-text">Used when Config source = file.</div>
            </div>
            <div class="field-grid">
              <div>
                <label>Action</label>
                <select id="risAction">
                  <option value="run">Run</option>
                  <option value="validate">Validate</option>
                </select>
              </div>
              <div>
                <label>Mode</label>
                <select id="risMode">
                  <option value="pattern">Pattern</option>
                  <option value="link">Link</option>
                </select>
              </div>
            </div>
            <div class="field" id="risReferenceField">
              <label>Reference file (CSV/NPZ/MAT)</label>
              <input id="risReferencePath" type="text" placeholder="refs/pattern.csv" />
              <div class="help-text">Required for validation runs.</div>
            </div>
            <div class="job-buttons">
              <button id="risStart" type="button">Run RIS Lab</button>
              <button id="risRefresh" type="button">Refresh Status</button>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Experiment</summary>
          <div class="panel-section-body">
            <div class="field-grid">
              <div>
                <label>Frequency (Hz)</label>
                <input id="risFreqHz" type="number" step="100000000" value="28000000000" />
              </div>
              <div>
                <label>Tx angle (deg)</label>
                <input id="risTxAngle" type="number" step="1" value="-30" />
              </div>
            </div>
            <div class="field-grid">
              <div>
                <label>Tx distance (m)</label>
                <input id="risTxDistance" type="number" step="0.01" value="0.4" />
              </div>
              <div>
                <label>Rx distance (m)</label>
                <input id="risRxDistance" type="number" step="0.01" value="2.0" />
              </div>
            </div>
            <div class="field-grid">
              <div>
                <label>Tx gain (dBi)</label>
                <input id="risTxGain" type="number" step="0.5" value="15" />
              </div>
              <div>
                <label>Rx gain (dBi)</label>
                <input id="risRxGain" type="number" step="0.5" value="22" />
              </div>
            </div>
            <div class="field-grid">
              <div>
                <label>Tx power (dBm)</label>
                <input id="risTxPower" type="number" step="0.5" value="28" />
              </div>
              <div>
                <label>Reflection coeff</label>
                <input id="risReflectionCoeff" type="number" step="0.01" value="0.84" />
              </div>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Geometry</summary>
          <div class="panel-section-body">
            <div class="field-grid">
              <div>
                <label>Elements X (nx)</label>
                <input id="risGeomNx" type="number" step="1" value="20" />
              </div>
              <div>
                <label>Elements Y (ny)</label>
                <input id="risGeomNy" type="number" step="1" value="20" />
              </div>
            </div>
            <div class="field-grid">
              <div>
                <label>Element spacing X (m)</label>
                <input id="risGeomDx" type="number" step="0.0001" value="0.0049" />
              </div>
              <div>
                <label>Element spacing Y (m)</label>
                <input id="risGeomDy" type="number" step="0.0001" value="0.0049" />
              </div>
            </div>
            <div class="field">
              <label>Origin (x y z)</label>
              <div class="triple">
                <input id="risOriginX" type="number" step="0.01" value="0" />
                <input id="risOriginY" type="number" step="0.01" value="0" />
                <input id="risOriginZ" type="number" step="0.01" value="0" />
              </div>
            </div>
            <div class="field">
              <label>Normal (x y z)</label>
              <div class="triple">
                <input id="risNormalX" type="number" step="0.1" value="1" />
                <input id="risNormalY" type="number" step="0.1" value="0" />
                <input id="risNormalZ" type="number" step="0.1" value="0" />
              </div>
            </div>
            <div class="field">
              <label>X-axis hint (x y z)</label>
              <div class="triple">
                <input id="risAxisX" type="number" step="0.1" value="0" />
                <input id="risAxisY" type="number" step="0.1" value="1" />
                <input id="risAxisZ" type="number" step="0.1" value="0" />
              </div>
            </div>
            <div class="field">
              <label>Element size override (m)</label>
              <input id="risElementSize" type="number" step="0.0001" placeholder="(optional)" />
              <div class="help-text">Leave blank to use dx * dy.</div>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Control</summary>
          <div class="panel-section-body">
            <div class="field">
              <label>Mode</label>
              <select id="risControlMode">
                <option value="steer">Steer</option>
                <option value="uniform">Uniform</option>
                <option value="focus">Focus</option>
              </select>
            </div>
            <div class="field-grid ris-control-steer">
              <div>
                <label>Azimuth (deg)</label>
                <input id="risSteerAz" type="number" step="1" value="0" />
              </div>
              <div>
                <label>Elevation (deg)</label>
                <input id="risSteerEl" type="number" step="1" value="0" />
              </div>
              <div>
                <label>Phase offset (deg)</label>
                <input id="risPhaseOffsetDeg" type="number" step="1" value="0" />
              </div>
            </div>
            <div class="field ris-control-uniform">
              <label>Uniform phase (deg)</label>
              <input id="risUniformPhaseDeg" type="number" step="1" value="0" />
            </div>
            <div class="field ris-control-focus">
              <label>Focal point (x y z)</label>
              <div class="triple">
                <input id="risFocusX" type="number" step="0.01" value="0" />
                <input id="risFocusY" type="number" step="0.01" value="0" />
                <input id="risFocusZ" type="number" step="0.01" value="0.8" />
              </div>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Quantization</summary>
          <div class="panel-section-body">
            <div class="field">
              <label>Phase bits</label>
              <select id="risQuantBits">
                <option value="0">Continuous</option>
                <option value="1" selected>1 bit</option>
                <option value="2">2 bit</option>
                <option value="3">3 bit</option>
                <option value="4">4 bit</option>
                <option value="6">6 bit</option>
                <option value="8">8 bit</option>
                <option value="10">10 bit</option>
              </select>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Pattern Sweep</summary>
          <div class="panel-section-body">
            <div class="field-grid">
              <div>
                <label>Start (deg)</label>
                <input id="risSweepStart" type="number" step="1" value="-90" />
              </div>
              <div>
                <label>Stop (deg)</label>
                <input id="risSweepStop" type="number" step="1" value="90" />
              </div>
              <div>
                <label>Step (deg)</label>
                <input id="risSweepStep" type="number" step="1" value="2" />
              </div>
            </div>
            <div class="field">
              <label>Normalization</label>
              <select id="risNormalization">
                <option value="peak_0db">Peak 0 dB</option>
                <option value="unit_power">Unit power</option>
                <option value="">None</option>
              </select>
            </div>
          </div>
        </details>

        <details class="panel-section">
          <summary>Config Preview</summary>
          <div class="panel-section-body">
            <pre class="code-block" id="risConfigPreview"></pre>
          </div>
        </details>
      </section>

      <section class="panel ris-panel">
        <details class="panel-section" open>
          <summary>Status</summary>
          <div class="panel-section-body">
            <div id="risJobStatus">Idle.</div>
            <div class="help-text" id="risProgress"></div>
            <pre class="log-view" id="risLog"></pre>
            <div class="job-status">
              <h3>Recent RIS Jobs</h3>
              <div id="risJobList"></div>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Experiment Preview</summary>
          <div class="panel-section-body">
            <div class="ris-preview">
              <svg id="risPreviewSvg" viewBox="0 0 600 220" preserveAspectRatio="xMidYMid meet">
                <rect x="0" y="0" width="600" height="220" fill="#0f172a"/>
                <line x1="80" y1="110" x2="520" y2="110" stroke="#334155" stroke-width="2"/>
                <rect id="risPreviewPanel" x="285" y="70" width="30" height="80" fill="#fbbf24"/>
                <circle id="risPreviewTx" cx="120" cy="110" r="10" fill="#ef4444"/>
                <circle id="risPreviewRx" cx="480" cy="110" r="10" fill="#22c55e"/>
                <line id="risPreviewTxRay" x1="120" y1="110" x2="300" y2="110" stroke="#f97316" stroke-width="2" stroke-dasharray="6 6"/>
                <line id="risPreviewRxRay" x1="300" y1="110" x2="480" y2="110" stroke="#38bdf8" stroke-width="2" stroke-dasharray="6 6"/>
                <text x="120" y="92" fill="#fca5a5" font-size="12" font-family="IBM Plex Mono">Tx</text>
                <text x="470" y="92" fill="#86efac" font-size="12" font-family="IBM Plex Mono">Rx</text>
                <text x="270" y="60" fill="#fde68a" font-size="12" font-family="IBM Plex Mono">RIS</text>
                <text id="risPreviewMeta" x="20" y="200" fill="#e2e8f0" font-size="12" font-family="IBM Plex Mono"></text>
              </svg>
            </div>
          </div>
        </details>

        <details class="panel-section" open>
          <summary>Results</summary>
          <div class="panel-section-body">
            <div class="field">
              <label>Run directory</label>
              <select id="risRunSelect"></select>
            </div>
            <div class="job-buttons">
              <button id="risLoadResults" type="button">Load Results</button>
            </div>
            <div id="risResultStatus" class="help-text"></div>
            <div class="metrics-card" id="risMetrics"></div>
            <div class="plot-tab-strip" id="risPlotTabs">
              <button class="plot-tab-button is-active" data-plot="phase_map.png" type="button">Phase</button>
              <button class="plot-tab-button" data-plot="pattern_cartesian.png" type="button">Pattern</button>
              <button class="plot-tab-button" data-plot="pattern_polar.png" type="button">Polar</button>
              <button class="plot-tab-button" data-plot="validation_overlay.png" type="button">Validation</button>
            </div>
            <figure class="plot-card single" id="risPlotSingle">
              <img id="risPlotImage" alt="RIS plot" />
              <figcaption id="risPlotCaption"></figcaption>
            </figure>
          </div>
        </details>

        <details class="panel-section">
          <summary>RIS Glossary</summary>
          <div class="panel-section-body glossary">
            <div class="glossary-item"><strong>Tx angle</strong> azimuth angle of the transmitter relative to the RIS normal.</div>
            <div class="glossary-item"><strong>Tx/Rx distance</strong> radial distance from RIS center to the Tx/Rx points.</div>
            <div class="glossary-item"><strong>Reflection coeff</strong> amplitude factor (ρ) applied to RIS elements.</div>
            <div class="glossary-item"><strong>Control: Steer</strong> reflectarray phase law: k·(R_i − r·k̂).</div>
            <div class="glossary-item"><strong>Control: Uniform</strong> sets all elements to the same phase.</div>
            <div class="glossary-item"><strong>Control: Focus</strong> near-field phase for a focal point.</div>
            <div class="glossary-item"><strong>Quantization bits</strong> phase resolution; 0 = continuous.</div>
            <div class="glossary-item"><strong>Sweep</strong> receiver azimuth scan range for patterns.</div>
            <div class="glossary-item"><strong>Normalization</strong> peak_0db or unit_power normalization.</div>
          </div>
        </details>
      </section>
    </div>
  </div>

  <template id="risItemTemplate">
    <div class="ris-item">
      <div class="ris-item-header">
        <strong>RIS</strong>
        <button type="button" class="ris-remove">Remove</button>
      </div>
      <div class="field-grid">
        <div>
          <label>Name</label>
          <input data-field="name" type="text" placeholder="ris1" />
        </div>
        <div>
          <label>Position (x y z)</label>
          <div class="triple">
            <input data-field="posX" type="number" step="0.1" />
            <input data-field="posY" type="number" step="0.1" />
            <input data-field="posZ" type="number" step="0.1" />
          </div>
        </div>
      </div>
      <div class="field-grid">
        <div>
          <label>Orientation (roll pitch yaw)</label>
          <div class="triple">
            <input data-field="oriX" type="number" step="0.01" />
            <input data-field="oriY" type="number" step="0.01" />
            <input data-field="oriZ" type="number" step="0.01" />
          </div>
        </div>
        <div>
          <label>Look-at (x y z)</label>
          <div class="triple">
            <input data-field="lookX" type="number" step="0.1" />
            <input data-field="lookY" type="number" step="0.1" />
            <input data-field="lookZ" type="number" step="0.1" />
          </div>
        </div>
      </div>
      <div class="field-grid">
        <div>
          <label>Rows / Cols / Modes</label>
          <div class="triple">
            <input data-field="rows" type="number" step="1" min="1" />
            <input data-field="cols" type="number" step="1" min="1" />
            <input data-field="modes" type="number" step="1" min="1" />
          </div>
        </div>
        <div>
          <label>Profile kind</label>
          <select data-field="profileKind">
            <option value="flat">flat</option>
            <option value="uniform">uniform</option>
            <option value="phase_gradient_reflector">phase_gradient_reflector</option>
            <option value="focusing_lens">focusing_lens</option>
          </select>
        </div>
        <div>
          <label class="toggle">
            <input data-field="autoAim" type="checkbox" />
            Boost toward Rx
          </label>
        </div>
      </div>
      <div class="field-grid">
        <div>
          <label>Sources (x y z)</label>
          <div class="triple">
            <input data-field="sourceX" type="number" step="0.1" />
            <input data-field="sourceY" type="number" step="0.1" />
            <input data-field="sourceZ" type="number" step="0.1" />
          </div>
        </div>
        <div>
          <label>Targets (x y z)</label>
          <div class="triple">
            <input data-field="targetX" type="number" step="0.1" />
            <input data-field="targetY" type="number" step="0.1" />
            <input data-field="targetZ" type="number" step="0.1" />
          </div>
        </div>
      </div>
      <div class="field-grid">
        <div>
          <label>Amplitude</label>
          <input data-field="amplitude" type="number" step="0.01" />
        </div>
        <div>
          <label>Phase bits</label>
          <input data-field="phaseBits" type="number" step="1" min="0" />
        </div>
      </div>
    </div>
  </template>
  </main>
  </div>
  <script type="module" src="app.js?v=dev"></script>
</body>

</html>
