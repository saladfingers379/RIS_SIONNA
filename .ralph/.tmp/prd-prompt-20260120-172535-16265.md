You are an autonomous coding agent.
Use the $prd skill to create a Product Requirements Document in JSON.
Save the PRD as JSON in directory: /home/josh/Documents/Github/RIS_SIONNA/.agents/tasks
Filename rules: prd-<short-slug>.json using 1-3 meaningful words.
Examples: prd-workout-tracker.json, prd-usage-billing.json
Do NOT implement anything.
After creating the PRD, end with:
PRD JSON saved to <path>. Close this chat and run `ralph build`.

User request:
# PROJECT: RIS Suite / RIS Lab inside RIS_SIONNAYou are Codex operating under the Ralph system. Your job is to implement a full “RIS Suite” inside this repository that lets us design, tweak, validate, and regression-test RIS behaviors against:1) the existing MATLAB reference model (provided by user),2) the target experimental methodology from the paper (Machado-style: near-field Tx, Rx azimuth sweep, 1-bit quantization, normalized patterns and/or received-power model),then *promote* the validated RIS into the main simulation pipeline.## Non-negotiables- CPU-only must work smoothly. GPU/OptiX acceleration is optional.- Clean CLI UX: progress bars, clear logs.- Each run saves outputs into a unique run directory: metrics + plots + config snapshot.- Simulator UI must stay responsive (no blocking).- Documentation freshness requirement:  - Before using any Sionna / Sionna RT APIs: look up the latest official docs and installation guides.  - Cite exact doc pages and versions in README.- Prefer incremental PRs: ship vertical slices; keep tests green.## High-level deliverableAdd a new simulator tab: **“RIS Lab”** (or similar), with a backend module that supports:1) RIS geometry + array definition (N×M, spacing, orientation, pose)2) RIS control synthesis:   - specular-like (uniform phase),   - steering to angle(s),   - focusing to a point,   - custom/imported phase matrices,   - quantization: continuous, 1-bit (0/π), and 2-bit (0/π/2/π/3π/2)3) Two validation modes:   A) Paper-style **normalized pattern mode** (RCS-like pattern shape vs Rx sweep)   B) Paper-style **received power / link model mode** (Eq(1)-style coherent sum with 1/(rt*rr), etc.)4) Regression harness:   - load MATLAB-exported reference results (.csv/.npz/.mat as feasible)   - compute error metrics (peak angle error, lobe levels, RMSE, etc.)   - produce a PASS/FAIL summary + plots5) Promotion path:   - once a RIS configuration passes validation, it can be enabled in the main sim as a “RIS compositor” module   - compositor integrates with the existing Sionna/RT scene pipeline without breaking CPU-only mode   - provide a feature flag / config toggle## Architecture constraints / philosophy- Treat RIS as a controlled scatterer. Implement a deterministic RIS compositor first (math-driven), then optionally integrate with ray tracing contributions later.- Separate concerns:  - ris_core (math, geometry, control synthesis)  - ris_validation (comparison vs MATLAB/paper)  - ris_ui (tab + widgets + plot viewing)  - ris_integration (main sim hook)- Export every important intermediate to disk for debugging:  - element centers, rt/rr arrays, Gamma (complex), phase map, pattern arrays, S sums, final metrics.## Required artifacts per runIn outputs/<run_id>/:- config.yaml/json snapshot- phase_map.png (and raw phase array)- pattern_cartesian.png + pattern_polar.png- metrics.json (peak angle, peak gain, sidelobe level, etc.)- if validation run: comparison plots + error report + PASS/FAIL## Acceptance criteria (must be testable)- RIS Lab tab appears and can run “Pattern Mode” and “Link Mode” headlessly via CLI.- A sample scenario replicates:  - Tx at -30°, Rx sweep -90..90 (2° steps)  - steering angles [0, 15, 45, 60]  - 1-bit quantization produces expected lobe behavior- Regression harness can ingest a provided MATLAB export file and produce:  - numeric summary  - comparison plot overlays  - a PASS/FAIL status with thresholds in config- Main sim: enabling RIS does not break non-RIS runs; CPU-only still works.## Implementation plan (execute in vertical slices)Slice 1: ris_core + CLI (no UI)- Implement geometry, steering/focus phase synthesis, quantization, and pattern mode.- Produce outputs and metrics.- Add unit tests for geometry + quantization.Slice 2: validation harness- Implement reference loader and comparator metrics.- Add a “golden” small reference fixture (toy) for CI.Slice 3: add RIS Lab tab UI- UI controls write config; running triggers backend job; UI displays artifacts.- Keep UI responsive (run in background process/thread as existing pattern).Slice 4: integrate RIS compositor into main sim- Add toggles to include RIS contribution and to choose RIS config from a validated run.Slice 5: docs + examples- Update README with setup, run commands, and citations to Sionna docs.## Guardrails- No hidden magic constants: keep all paper/matlab constants in config.- No mixing antenna gains with cosine pattern exponents.- Phase conventions: define them explicitly; include a reference-element option for stability.Now implement this in the repo:- Add/modify modules, tests, CLI commands, UI tab.- Keep code style consistent with the repo.- Add clear docs and example configs.
